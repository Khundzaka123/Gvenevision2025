<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>გვენევიზია 2025 - შეფასება</title>
<style>
  body {
    font-family: 'Jomhuria', cursive, Arial, sans-serif;
    background: linear-gradient(135deg, #9b59b6, #8e44ad);
    color: white;
    margin: 0; padding: 20px;
  }
  #passwordPopup {
    position: fixed; top: 0; left: 0; right:0; bottom:0;
    background: rgba(0,0,0,0.7);
    display: flex; justify-content:center; align-items:center;
    visibility: hidden; opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 1000;
  }
  #passwordPopup.active {
    visibility: visible; opacity: 1;
  }
  #passwordPopup .popup-content {
    background: #6e2a92;
    padding: 30px 40px;
    border-radius: 20px;
    box-shadow: 0 0 40px #d1aaff;
    text-align: center;
  }
  #passwordPopup input {
    padding: 10px 15px;
    font-size: 1.2rem;
    border-radius: 15px;
    border: none;
    outline: none;
    width: 220px;
    margin-top: 15px;
    font-weight: 700;
    color: #6e2a92;
  }
  #passwordPopup button {
    margin-top: 20px;
    padding: 12px 25px;
    background: #9b59b6;
    border: none;
    border-radius: 30px;
    font-size: 1.3rem;
    font-weight: 700;
    color: white;
    cursor: pointer;
    box-shadow: 0 0 25px #bb99ff;
  }
  #passwordPopup .error {
    color: #ff5959;
    margin-top: 12px;
    font-weight: 700;
    display: none;
  }
  #results {
    max-width: 720px;
    margin: 20px auto;
    background: rgba(255 255 255 / 0.15);
    border-radius: 20px;
    padding: 20px 30px;
    color: #ede9ff;
    font-weight: 600;
    font-size: 1.25rem;
    box-shadow: 0 0 30px #c9baff;
    user-select: text;
    white-space: pre-line;
    display: none;
  }
</style>
</head>
<body>

<h1>გვენევიზია 2025 - შეფასება</h1>
<h2>შეაფასე თითოეული მონაწილე - 1-დან 25 ქულამდე თითო კრიტერიუმში</h2>

<form id="votingForm" autocomplete="off" spellcheck="false">
  <div class="participant" data-name="ნიკი მინაჟი">
    <div class="participant-header">
      <img src="https://i.imgur.com/tkT8swz.jpeg" alt="ნიკი მინაჟი" class="face" />
      <div class="participant-name">ნიკი მინაჟი</div>
    </div>
    <div class="criteria">
      <label>ვოკალი (1-25)
        <input type="number" min="1" max="25" required name="niki_vocal" />
      </label>
      <label>ქორეოგრაფია (1-25)
        <input type="number" min="1" max="25" required name="niki_choreo" />
      </label>
      <label>ტექსტი (1-25)
        <input type="number" min="1" max="25" required name="niki_lyrics" />
      </label>
      <label>საბოლოო (1-25)
        <input type="number" min="1" max="25" required name="niki_overall" />
      </label>
    </div>
  </div>
  <div class="participant" data-name="სეიბერი">
    <div class="participant-header">
      <img src="https://i.imgur.com/XJbGztL.jpeg" alt="სეიბერი" class="face" />
      <div class="participant-name">სეიბერი</div>
    </div>
    <div class="criteria">
      <label>ვოკალი (1-25)
        <input type="number" min="1" max="25" required name="cyber_vocal" />
      </label>
      <label>ქორეოგრაფია (1-25)
        <input type="number" min="1" max="25" required name="cyber_choreo" />
      </label>
      <label>ტექსტი (1-25)
        <input type="number" min="1" max="25" required name="cyber_lyrics" />
      </label>
      <label>საბოლოო (1-25)
        <input type="number" min="1" max="25" required name="cyber_overall" />
      </label>
    </div>
  </div>
  <button type="submit" class="vote-btn">შეაფასე მონაწილეები</button>
</form>

<button id="showResultsBtn" type="button">შედეგების ნახვა</button>

<pre id="results" aria-live="polite" role="region"></pre>

<!-- პაროლის მოდალი -->
<div id="passwordPopup">
  <div class="popup-content">
    <div>შეიყვანეთ პაროლი შედეგების სანახავად:</div>
    <input id="passwordInput" type="password" placeholder="პაროლი..." autocomplete="off" />
    <button id="passwordSubmitBtn">დადასტურება</button>
    <div id="passwordError" class="error">პაროლი არასწორია!</div>
  </div>
</div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
  // აქ ჩაანაცვლე შენი Firestore კონფიგურაცია:
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY_HERE",
    authDomain: "YOUR_AUTH_DOMAIN_HERE",
    projectId: "YOUR_PROJECT_ID_HERE",
    storageBucket: "YOUR_STORAGE_BUCKET_HERE",
    messagingSenderId: "YOUR_MSG_SENDER_ID",
    appId: "YOUR_APP_ID_HERE"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const form = document.getElementById('votingForm');
  const results = document.getElementById('results');
  const showResultsBtn = document.getElementById('showResultsBtn');
  const passwordPopup = document.getElementById('passwordPopup');
  const passwordInput = document.getElementById('passwordInput');
  const passwordSubmitBtn = document.getElementById('passwordSubmitBtn');
  const passwordError = document.getElementById('passwordError');

  const correctPassword = "ლაურამ123ქნა";

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = new FormData(form);

    let docData = {
      timestamp: new Date().toISOString()
    };

    for (const [key, value] of data.entries()) {
      docData[key] = value;
    }

    try {
      await db.collection('votes').add(docData);
      alert('შენი შეფასება წარმატებით გაიგზავნა!');
      form.reset();
    } catch (error) {
      alert('შეტყობინება ვერ გაიგზავნა, სცადე თავიდან.');
      console.error(error);
    }
  });

  showResultsBtn.addEventListener('click', () => {
    passwordInput.value = '';
    passwordError.style.display = 'none';
    passwordPopup.classList.add('active');
  });

  passwordSubmitBtn.addEventListener('click', async () => {
    const enteredPassword = passwordInput.value.trim();
    if (enteredPassword === correctPassword) {
      passwordPopup.classList.remove('active');
      passwordError.style.display = 'none';

      try {
        const snapshot = await db.collection('votes').orderBy('timestamp', 'desc').get();
        if (snapshot.empty) {
          results.textContent = "შენახული მონაცემები არ არის.";
        } else {
          let allResults = '';
          snapshot.forEach(doc => {
            const vote = doc.data();
            allResults +=
              `პარასკევი: ${vote.timestamp}\n` +
              `ნიკი მინაჟი: ვოკალი=${vote.niki_vocal}, ქორეოგრაფია=${vote.niki_choreo}, ტექსტი=${vote.niki_lyrics}, საბოლოო=${vote.niki_overall}\n` +
              `სეიბერი: ვოკალი=${vote.cyber_vocal}, ქორეოგრაფია=${vote.cyber_choreo}, ტექსტი=${vote.cyber_lyrics}, საბოლოო=${vote.cyber_overall}\n\n`;
          });
          results.textContent = allResults;
        }
        results.style.display = 'block';
      } catch (error) {
        results.textContent = "შეტყობინება ვერ იქნა წამოღებული.";
        results.style.display = 'block';
        console.error(error);
      }
    } else {
      passwordError.style.display = 'block';
    }
  });
</script>
</body>
</html>
